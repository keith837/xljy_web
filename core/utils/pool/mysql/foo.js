!function(o,n){var t=require("mysql"),i=require("../../../config/mysqlConfig"),e=require("../../common/strUtils"),r=require("../../logger/logger")(__filename),s=function(){this.pool,this.init()};s.prototype.init=function(){this.pool=t.createPool({debug:i.DEBUG,connectionLimit:i.POOLSIZE,host:i.HOST,port:i.PORT,user:i.USER,password:i.PASSWORD,charset:i.CHARSET,database:i.DATABASE}),this.pool.on("connection",function(o){console.log("连接池连接success")}),this.pool.on("error",function(o){r.error(o)})},s.prototype.query=function(o,n,e){this.pool.getConnection(function(s,c){if(s&&"PROTOCOL_SEQUENCE_TIMEOUT"===s.code)throw new Error("too long to count table rows!");if(s)return void e(s,c);var u=t.format(o,n);i.PRINTSQL&&r.info(u),c.query({sql:u,timeout:i.QUERYTIMEOUT},function(o,n){c.release(),e(o,n)})})},s.prototype.transaction=function(o){this.pool.getConnection(function(n,t){return n?void o(n):void t.beginTransaction(function(n){o(n,t)})})},module.exports=new s,o.mysql=t,o.mysqlConfig=i,o.strUtils=e,o.logger=r,o.mysqlPool=s,n[""]=o}({},function(){return this}());
//# sourceMappingURL=foo.js.map